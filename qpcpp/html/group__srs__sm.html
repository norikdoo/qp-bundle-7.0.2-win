<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QP/C++: State Machines</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="ql-preview.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="ql-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
  <div id="projectlogo">
    <a href="https://www.state-machine.com" title="Quantum Leaps"><img alt="Logo" src="logo_ql.png"/></a>
  </div>
   <div id="projectname">
    QP/C++
    &nbsp;<span id="projectnumber">7.0.2</span>
   </div>
   <div id="projectbrief">Real-Time Embedded Framework</div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;"
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__srs__sm.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0"
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle"><div class="title">State Machines<div class="ingroups"><a class="el" href="group__srs.html">Requirements</a></div></div></div>
</div><!--header-->
<div class="contents">
<p ><span class="prev_button"><a class="el" href="group__srs__evt.html">Events</a></span><span class="next_button"><a class="el" href="group__srs__ao.html">Active Objects</a></span></p>
<p >The behavior of event-driven components (Active Objects, as well as passive event-driven objects) is specified in <a class="el" href="namespace_q_p.html" title="QP/C++ framework.">QP</a> Applications through <a href="https://www.state-machine.com/fsm#HSM" class="extern" target="_blank">Hierarchical State Machines</a> (a.k.a. UML statecharts). The main effort of <a class="el" href="namespace_q_p.html" title="QP/C++ framework.">QP</a> Application developers typically goes into elaborating the internal state machines of the various objects in the <a class="el" href="namespace_q_p.html" title="QP/C++ framework.">QP</a> Application. Therefore the description of state machine features and associated requirements is provided early in this SRS document.</p>
<h1><a class="anchor" id="srs_sm_impl"></a>
State Machine Implementation Strategies</h1>
<p >State Machines, and Hierarchical State Machines, in particular, can be implemented in many different ways. A specific way of implementing a state machine will be called here a <b>State Machine Implementation Strategy</b>, and it can be characterized by the following properties:</p>
<ul>
<li>efficiency in time (CPU cycles)</li>
<li>efficiency in data space (RAM footprint)</li>
<li>efficiency in code space (ROM footprint)</li>
<li>monolithic vs. partitioned with various levels of granularity</li>
<li>maintainability (with manual coding)</li>
<li>maintainability (via automatic code generation)</li>
<li><em>traceability</em> from design (e.g., state diagram) to code</li>
<li><em>traceability</em> from code back to design</li>
<li>other, quality attributes (non-functional requirements)</li>
</ul>
<p >No single State Machine Implementation Strategy can be optimal for all circumstances, and therefore <a class="el" href="namespace_q_p.html" title="QP/C++ framework.">QP</a> Framework shall support multiple and interchangeable strategies (see RQP102).</p>
<h1><a class="anchor" id="src_sm_proc"></a>
Dispatching Events to a State Machine in QP Framework</h1>
<p >The event processing inside a state machine is called <b>dispatching</b> an event to the state machine, and it requires interaction between the <a class="el" href="namespace_q_p.html" title="QP/C++ framework.">QP</a> Framework and the <a class="el" href="namespace_q_p.html" title="QP/C++ framework.">QP</a> Application:</p>
<p ><img src="sm_proc.png" alt="" class="inline" title="Event Dispatching in QP Framework"/>     </p><div class="caption" align="center">Event Dispatching to a State Machine in <a class="el" href="namespace_q_p.html" title="QP/C++ framework.">QP</a> Framework</div><h2><a class="anchor" id="srs_sm_spec"></a>
State Machine Specification</h2>
<p >The "State Machine Specification" is provided inside the <a class="el" href="namespace_q_p.html" title="QP/C++ framework.">QP</a> Application and is prepared according to the rules defined by the chosen State Machine Implementation Strategy in <a class="el" href="namespace_q_p.html" title="QP/C++ framework.">QP</a> Framework. Typically an implementation strategy represents a state machine as several elements, such as states, transitions, etc.</p>
<p >The "State Machine Specification" can mean state machine code (when the state machine is coded manually) or a state machine model (when the state machine is specified in a modeling tool, like <a href="https://www.state-machine.com//products/qm" class="extern" target="_blank">"QM"</a>). Either way, it is highly recommended to <em>think</em> of the state machine implementation as the <b>specification</b> of state machine elements, not merely code. This notion of "specifying" a state machine rather than coding it can be reinforced by selecting an expressive and fully <em>traceable</em> state machine implementation strategy, see RQP103. The advantage of a traceable implementation is that each artifact at all levels of abstraction (design to code) unambiguously represents an element of a state machine.</p>
<h2><a class="anchor" id="srs_sm_proc"></a>
State Machine Processor</h2>
<p >A state machine is executed in <a class="el" href="namespace_q_p.html" title="QP/C++ framework.">QP</a> Framework by the "State Machine Processor" that decides which elements of the "State Machine Specification" to call (see also <a class="el" href="group__srs__over.html#srs_intro_inv">Inversion of Control</a>). Once called, the chosen part of the "State Machine Specification" executes some actions and <em>returns</em> back to the "State Machine Processor" (<a class="el" href="namespace_q_p.html" title="QP/C++ framework.">QP</a> Framework) with the status information as to what has happened. For example, the returned status might inform the "State Machine Processor" that a state transition needs to be taken, or that the event needs to be propagated to the superstate in the hierarchical state machine.</p>
<h2><a class="anchor" id="srs_sm_rtc"></a>
Run To Completion (RTC) Processing</h2>
<p >The "State Machine Processor" is a <em>passive</em> software component that needs to be explicitly called from some control thread to dispatch each event to the given state machine object. The most important restriction is that the dispatch operation must necessarily run to completion (<b>Run-to-Completion</b> processing) before another event can be dispatched to the same state machine object.</p>
<dl class="section note"><dt>Note</dt><dd>RTC event processing does <b>NOT</b> mean that a state machine has to monopolize the CPU until the RTC step is complete. In a multithreading environment, other threads or interrupts (not related to the thread context of the busy state machine) <em>can</em> be running, possibly preempting the currently executing state machine. But after every preemption, the preempted state machine picks up where it left off and continues processing the current event, eventually completing its RTC step.<br  />
 <br  />
 RTC event processing also means that a state machine should <b>NOT</b> make blocking calls (e.g., a time-delay or semaphore-wait), because every blocking call represents waiting for an <em>event</em>, which will be delivered after the call unblocks. The problem is that such a "backdoor" event is delivered before the original RTC step completes, thus violating the RTC semantics. Blocking inside a state machine also extends the RTC processing and makes the state machine unresponsive to new events.</dd></dl>
<h1><a class="anchor" id="src_sm_req"></a>
Requirements</h1>
<p ><a href="https://www.state-machine.com/products/qp#CERT" title="QP Cert-Pack"><img src="cert-pack-pre.png" alt="" style="float:left; margin:0 20px 20px 0;" class="inline"/></a> <b>NOTE:</b> This is just a preview of the <a href="https://www.state-machine.com/products/qp#CERT" class="extern" target="_blank">QP Certification Pack</a>. The list of requirements is provided in the complete document, which can be <a href="https://www.state-machine.com/licensing#RequestForm" class="extern" target="_blank">requested from Quantum Leaps</a>. </p><div style="clear:both"></div><p>  <br  />
 <span class="prev_button"><a class="el" href="group__srs__evt.html">Events</a></span><span class="next_button"><a class="el" href="group__srs__ao.html">Active Objects</a></span> </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; 2005-2022 Quantum Leaps</a> &nbsp;|&nbsp; <a title="help" href="help.html">Using Online Help</a> &nbsp;|&nbsp; <b>QP/C++ 7.0.2</b> &nbsp;|&nbsp; Updated on Sat Aug 13 2022
<hr class="footer"/><address class="footer"><small>
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; 2005-2022 Quantum Leaps</a> &nbsp;|&nbsp; <a title="help" href="help.html">Using Online Help</a> &nbsp;|&nbsp; <b>QP/C++ 7.0.2</b> &nbsp;|&nbsp; Updated on Sat Aug 13 2022
</small></address>
    </li>
  </ul>
</div>
</body>
</html>
